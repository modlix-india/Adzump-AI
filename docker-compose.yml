version: "3.9"
services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    image: ds-service:latest
    restart: unless-stopped
    ports:
      - "8000:8000"
    env_file:
      - .env
    volumes:
      - ./uploads:/app/uploads
    # For heavy pages with Playwright/Chromium you can increase shared memory:
    # shm_size: 1gb
    # If you ever must run Chromium without sandbox (not recommended):
    # user: "0:0"
    # environment:
    #   - CHROMIUM_FLAGS=--no-sandbox


#version: "3.9"
#
#services:
#  web:
#    # Option A: Pull from GHCR (recommended for CI/CD)
#    image: ghcr.io/modlix-india/adzump-ai:${TAG:-latest}
#
#    # Option B: Build locally on the server instead of pulling
#    # build: .
#
#    # Server-managed environment variables
#    env_file:
#      - /opt/adzump-ai/.env
#
#    environment:
#      # Ensure the app binds to the port we expose
#      - PORT=8000
#
#    # Expose only to the host (for Nginx reverse proxy). No public exposure.
#    ports:
#      - "127.0.0.1:8000:8000"
#
#    # Persist uploads if your app writes to /app/uploads
#    # Uncomment and set a host path if you need persistence
#    # volumes:
#    #   - /opt/adzump-ai/uploads:/app/uploads
#
#    restart: unless-stopped
#
#    # Match Dockerfile healthcheck endpoint as needed
#    healthcheck:
#      test: ["CMD", "curl", "-fsS", "http://localhost:8000/health"]
#      interval: 30s
#      timeout: 5s
#      retries: 3